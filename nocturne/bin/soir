#!/usr/bin/env bash

set -e

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
VENV_DIR="${SCRIPT_DIR}/../.venv"

if [ ! -d "${VENV_DIR}" ]; then
    echo "Error: Virtual environment not found at ${VENV_DIR}" >&2
    exit 1
fi

# We need -Xgil=0 to prevent python from enabling it at runtime
# whenever a module that doesn't explicitly express thread-free
# semantics is imported (for example: watchdog).

exec "${VENV_DIR}/bin/python" -Xgil=0 -m soir.app "$@"
