// Maethstro L I V E
//
// There are two services:
//
// Midi: processes incoming requests from Matin
// Soir: processes incoming requests from Midi 

syntax = "proto3";

package proto;

// Used to send a code update to Midi.
message MatinLiveUpdate {
  message Request {
    optional string username = 1;
    optional string code = 2;
  }

  message Response {}
}

message MidiLiveNotification {
  message Request {}

  // Log message from Midi.
  message Log {
    optional string source = 1;
    optional string notification = 2;
  }

  // Nofification from Midi.
  message Notification {
    oneof notification {
      Log log = 1;
    }
  }
}

// Midi service.
service Midi {
  // Used by Matin to send code updates.
  rpc LiveUpdate(MatinLiveUpdate.Request) returns (MatinLiveUpdate.Response) {}

  // Used by Matin to receive notifications.
  rpc LiveNotifications(MidiLiveNotification.Request) returns (stream MidiLiveNotification.Notification) {}
}
